!function(){"use strict";function e(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))}function t(e,t){var n,r,a,s,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}var n,r,a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s={getHackathonData:function(e){return i.get(i._PREFIX+"hackathons/"+e).then((function(e){var t,n;if(!(null==e?void 0:e.error))return{uuid:e.uuid,slug:e.slug,name:e.name,regEndsAt:null===(t=null==e?void 0:e.hackathon_setting)||void 0===t?void 0:t.reg_ends_at,regStartsAt:null===(n=null==e?void 0:e.hackathon_setting)||void 0===n?void 0:n.reg_starts_at,endsAt:null==e?void 0:e.ends_at,devfolioOfficial:(null==e?void 0:e.devfolio_official)||!1};throw e.error}))},signIn:function(e,t,n){return i.post(i._PREFIX+"users/signin",{username:e,password:t,captcha_response:n}).then((function(t){var n;if(!(null==t?void 0:t.error))return{username:t.username,uuid:t.uuid,roles:t.roles,accessToken:t.access_token,refreshToken:t.refresh_token};var r=[];switch(null===(n=t.error)||void 0===n?void 0:n.message){case"Invalid username":r.push({field:"id",message:"Sorry, we couldn't find an account with that username."});break;case"Account with this email or username does not exists":r.push({field:"id",message:"Sorry, we couldn't find an account with that "+(e.includes("@")?"email":"username")});break;case"Invalid Password":r.push({field:"password",message:"Sorry, that password isn't right."});break;case"Invalid captcha response":r.push({field:"generic",message:"Sorry, we could not sign you in as the captcha validation failed."});break;case"Login attempts over":r.push({field:"generic",message:"The maximum number of login attempts has been reached. Please try again in an hour."})}throw 0===r.length&&(s.captureException(t.error),r.push({field:"generic",message:"Sorry, we could not sign you in at the moment."})),r}))},register:function(e,t,n,r){return i.post(i._PREFIX+"users",{email:t,password:n,username:e,mailing_lists_opt_in:r}).then((function(e){var t,n,r,a,i;if(!(null==e?void 0:e.error))return{username:e.username,uuid:e.uuid,roles:e.roles,accessToken:e.access_token,refreshToken:e.refresh_token};var o=[];if("The server received a request that could not be processed."===(null===(t=e.error)||void 0===t?void 0:t.message)){var c=null===(n=e.error)||void 0===n?void 0:n.source;if(null==c?void 0:c.email)switch(null===(r=c.email)||void 0===r?void 0:r.msg){case"email already in use":o.push({field:"email",message:"Someone (maybe you?) has already created an account using this email."});break;case"must be an email":o.push({field:"email",message:"This doesn't appear to be a valid email address. Please try a different email address."})}if(null==c?void 0:c.username)switch(null===(a=c.username)||void 0===a?void 0:a.msg){case"username not available":o.push({field:"username",message:"Another user with this username already exists. Please try a different username."});break;case"invalid username":o.push({field:"username",message:"Username must be minimum 2 characters long, and should not contain spaces or special characters."})}if(null==c?void 0:c.password)switch(null===(i=c.password)||void 0===i?void 0:i.msg){case"password must be atleast 8 characters long":o.push({field:"password",message:"Password must be minimum 8 characters long."})}}throw 0===o.length&&(s.captureException(e.error),o.push({field:"generic",message:"Sorry, we could not create your account at the moment."})),o}))},apply:function(e,t,n){var r="users/"+e+"/hackathon/"+t+"/apply";return i.post(i._PREFIX+r,{},a(a({},i._HEADERS),{access_token:n})).then((function(e){var t;if(!(null==e?void 0:e.error))return e;var n={field:"generic",message:"Unable to apply to this hackathon."};switch(null===(t=e.error)||void 0===t?void 0:t.message){case"Can't apply, hackathon registrations are not open.":n.message="Sorry, the hackathon registrations are not open.";break;case"Can't apply, hackathon registration are close.":n.message="Sorry, this hackathon is no longer accepting new registrations.";break;default:s.captureException(e.error)}throw n}))},getOrganizedHackathons:function(e,t){return i.get(i._PREFIX+"users/"+e+"/my_organized_hackathons",a(a({},i._HEADERS),{access_token:t})).then((function(e){if(!(null==e?void 0:e.error))return{data:e};throw s.captureException(e.error),e.error}))},captureException:function(e){var t;null===(t=null===window||void 0===window?void 0:window.Sentry)||void 0===t||t.captureException(e)}},i={_PREFIX:"https://api.devfolio.co/api/",_HEADERS:{"Content-Type":"application/json; charset=utf-8"},get:function(e,t){return void 0===e&&(e=""),fetch(e,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:t||i._HEADERS,referrer:"no-referrer"}).then((function(e){return e.json()})).catch((function(e){throw e}))},post:function(e,t,n){return void 0===e&&(e=""),void 0===t&&(t={}),fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:n||i._HEADERS,referrer:"no-referrer",body:JSON.stringify(t)}).then((function(e){var t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():e})).catch((function(e){throw e}))}};!function(e){e.SignIn="signin",e.Register="register"}(n||(n={})),function(e){e[e.Ready=0]="Ready",e[e.Progress=1]="Progress",e[e.Success=2]="Success",e[e.Failed=3]="Failed"}(r||(r={})),window.addEventListener("load",(function(){var a,i={form:document.querySelector("#signin-form"),id:document.querySelector("#signin-id"),password:document.querySelector("#signin-password"),switch:document.querySelector("#signin-switch")},o={form:document.querySelector("#register-form"),email:document.querySelector("#register-email"),username:document.querySelector("#register-username"),password:document.querySelector("#register-password"),newsletter:document.querySelector("#register-subscribe-newsletter"),switch:document.querySelector("#register-switch")},c=((a={})[n.SignIn]=i,a[n.Register]=o,a),u=document.querySelector("#button-close"),d=document.querySelector("#button-continue"),l={auth:{username:"",uuid:"",accessToken:"",refreshToken:"",roles:[]},hackathon:{uuid:"",slug:"",name:"",devfolioOfficial:!1,regEndsAt:"",regStartsAt:""},currentView:n.Register,formStatus:r.Ready,dispatch:{setAuth:function(e){l.auth=e},setHackathon:function(e){l.hackathon=e,document.querySelector("#banner-hackathon-name").innerHTML=e.name,d.disabled=!1},setFormStatus:function(e){switch(l.formStatus=e,e){case r.Progress:d.classList.add("loading"),d.disabled=!0,i.switch.disabled=!0,o.switch.disabled=!0,u.disabled=!0;break;default:d.classList.remove("loading"),d.disabled=!1,i.switch.disabled=!1,o.switch.disabled=!1,u.disabled=!1}},setCurrentView:function(e){var t=c[l.currentView],n=c[e];t.form.classList.add("hidden"),t.form.setAttribute("disabled","true"),n.form.setAttribute("disabled","false"),n.form.classList.remove("hidden"),d.setAttribute("form",e+"-form"),l.currentView=e}}};function h(){var e=l.currentView===n.Register?n.SignIn:n.Register;l.dispatch.setCurrentView(e)}function f(e){try{e.preventDefault(),window.grecaptcha.execute()}catch(e){console.log("(Overlay): ",e),window.Sentry.captureException(e)}}i.switch.addEventListener("click",h),o.switch.addEventListener("click",h),window.continueToDashboard=function(a){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return t.trys.push([0,10,11,12]),l.dispatch.setFormStatus(r.Progress),l.currentView!==n.SignIn?[3,2]:[4,g(a)];case 1:return t.sent(),[3,4];case 2:return[4,v()];case 3:t.sent(),t.label=4;case 4:return window.rudderanalytics&&(window.rudderanalytics.identify(l.auth.uuid),l.currentView===n.SignIn?window.rudderanalytics.track("Sign in and apply to hackathon from apply now script",{hackathonSlug:l.hackathon.slug}):window.rudderanalytics.track("Sign up and apply to hackathon from apply now script",{hackathonSlug:l.hackathon.slug})),[4,w()];case 5:return t.sent()?(p(l.currentView,"password","It seems like you're the organizer of this initiative. Organizers cannot apply to their own initiatives."),l.dispatch.setFormStatus(r.Failed),[3,9]):[3,6];case 6:return[4,y()];case 7:return t.sent(),[4,new Promise((function(e,t){try{var n=l.hackathon,r=l.auth,a={hackathon_slug:n.slug,uuid:r.uuid,access_token:r.accessToken,refresh_token:r.refreshToken,roles:r.roles};window.parent.location.href="https://devfolio.co/apply?token="+btoa(JSON.stringify(a)),e(a)}catch(e){t(e)}}))];case 8:t.sent(),l.dispatch.setFormStatus(r.Success),t.label=9;case 9:return[3,12];case 10:return e=t.sent(),console.log("(Overlay): ",e),l.dispatch.setFormStatus(r.Failed),[3,12];case 11:return window.grecaptcha.reset(),[7];case 12:return[2]}}))}))},i.form.addEventListener("submit",f),o.form.addEventListener("submit",f);var m,p=function(e,t,n){if("generic"!==t){var r=document.querySelector("#"+e+"-"+t);document.querySelector("#"+e+"-"+t+"-error").innerHTML=n,r.classList.add("error")}else{document.querySelector("#generic-error").innerHTML=n}};function g(r){var a=this;return new Promise((function(o,c){return e(a,void 0,void 0,(function(){var e,a,u,d;return t(this,(function(t){switch(t.label){case 0:e=i.id.value,a=i.password.value,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,s.signIn(e,a,r)];case 2:return u=t.sent(),l.dispatch.setAuth(u),o(u),[3,4];case 3:return d=t.sent(),Array.isArray(d)&&d.forEach((function(e){p(n.SignIn,e.field,e.message)})),c(d),[3,4];case 4:return[2]}}))}))}))}function v(){var r=this;return new Promise((function(a,i){return e(r,void 0,void 0,(function(){var e,r,c,u,d,h;return t(this,(function(t){switch(t.label){case 0:e=o.email.value,r=o.username.value,c=o.password.value,u=o.newsletter.checked,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,s.register(r,e,c,u)];case 2:return d=t.sent(),l.dispatch.setAuth(d),a(d),[3,4];case 3:return h=t.sent(),Array.isArray(h)&&h.forEach((function(e){p(n.Register,e.field,e.message)})),i(h),[3,4];case 4:return[2]}}))}))}))}function w(){var n=this;return new Promise((function(r,a){return e(n,void 0,void 0,(function(){var e;return t(this,(function(t){return e=l.auth,s.getOrganizedHackathons(e.username,e.accessToken).then((function(e){var t;(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.map((function(e){return e.slug}))).includes(l.hackathon.slug)?r(!0):r(!1)})).catch((function(e){a(e)})),[2]}))}))}))}function y(){var n=this;return new Promise((function(r,a){return e(n,void 0,void 0,(function(){var e,n,i;return t(this,(function(t){switch(t.label){case 0:e=l.hackathon,n=l.auth,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,s.apply(n.username,e.uuid,n.accessToken)];case 2:return t.sent(),r(e),[3,4];case 3:return(null==(i=t.sent())?void 0:i.field)&&(null==i?void 0:i.message)&&p(l.currentView,i.field,i.message),a(i),[3,4];case 4:return[2]}}))}))}))}function b(){window.parent.postMessage({type:"CLOSE_OVERLAY"},"*")}document.querySelectorAll(".input").forEach((function(e){e.addEventListener("input",(function(){e.classList.remove("error")}))})),u.addEventListener("click",b),window.addEventListener("keydown",(function(e){"Escape"===e.key&&l.formStatus!==r.Progress&&b()})),window.addEventListener("message",(function(e){var t=e.isTrusted,n=e.data;t&&"SEND_HACKATHON_DATA"===(null==n?void 0:n.type)&&l.dispatch.setHackathon(e.data.payload)})),(m=document.createElement("script")).src="https://js.sentry-cdn.com/9e00427c767b4e838f64e7581b3952d5.min.js",m.crossOrigin="anonymous",m.addEventListener("load",(function(){window.Sentry.init({environment:"production"}),window.Sentry.configureScope((function(e){var t=l.hackathon;e.setTag("hackathon",t.name),e.setExtras(t)}))})),document.head.appendChild(m)})),window.grecaptchaOnload=function(){window.grecaptcha.render("g-recaptcha",{sitekey:"6LexNNUUAAAAAN_eHY_-SHuzT1JjQZ-hbUebX35S",callback:"continueToDashboard",size:"invisible"})}}();
//# sourceMappingURL=bundle.js.map
